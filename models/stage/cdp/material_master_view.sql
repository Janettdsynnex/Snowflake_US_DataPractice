

with t6 as (select distinct t1."/BIC/TUCMATERL"
	        from {{ source('us_cdp_bw_46','TUCMATERL') }}  as t1 
	        left join {{ source('us_cdp_bw_46','TUCMATSAS') }}   as t3 
	          on t1."/BIC/TUCMATERL" = t3."/BIC/TUCMATSAS" 
	        and t1.SOURSYSTEM = t3.SOURSYSTEM 
	        and t1.OBJVERS = t3.OBJVERS
	        and t3."/BIC/TUCDISTRN" = '00'
	      where (t3."/BIC/TUCVMSTA" = '' 
	          or t3."/BIC/TUCVMSTA" is null 
	          or t3."/BIC/TUCVMSTA" < 70) 
	         and t3."/BIC/TUCINT65" = '' 
	         and t3."/BIC/TUCINT01" = '')

             
select 
md5(concat(t1.SOURSYSTEM,t1."/BIC/TUCMATERL",nvl(t3."/BIC/TUCSALESG",''),nvl(t3."/BIC/TUCDISTRN",''))) as pkey_material,
t1.SOURSYSTEM as SOURSYSTEM,
t1."/BIC/TUCMATERL" as TUCMATERL,
t1.OBJVERS as OBJVERS,
nvl(t3."/BIC/TUCSALESG",'') as TUCSALESG,
nvl(t3."/BIC/TUCDISTRN",'') as TUCDISTRN,
t3."/BIC/TUCMATSAS" as TUCMATSAS,
t1.LOGSYS as LOGSYS,
t1."/BIC/TUCACTC" as TUCACTC,
t1."/BIC/TUCAESZNN" as TUCAESZNN,
t1."/BIC/TUCARCH" as TUCARCH_TUCMATERL,
t1."/BIC/TUCBUNDFL" as TUCBUNDFL,
t1."/BIC/TUCCNETL1" as TUCCNETL1,
t1."/BIC/TUCCNETL2" as TUCCNETL2,
t1."/BIC/TUCCNETL3" as TUCCNETL3,
t1."/BIC/TUCCNETL4" as TUCCNETL4,
t1."/BIC/TUCCNETL5" as TUCCNETL5,
t1."/BIC/TUCCNETL6" as TUCCNETL6,
t1."/BIC/TUCCNETL7" as TUCCNETL7,
t1."/BIC/TUCCNETL8" as TUCCNETL8,
t1."/BIC/TUCCOMCHA" as TUCCOMCHA,
t1."/BIC/TUCCOMPER" as TUCCOMPER,
t1."/BIC/TUCDELFLG" as TUCDELFLG_TUCMATERL,
t1."/BIC/TUCDIVISN" as TUCDIVISN,
t1."/BIC/TUCEANUPC" as TUCEANUPC,
t1."/BIC/TUCEKWSL" as TUCEKWSL,
t1."/BIC/TUCEXTMAP" as TUCEXTMAP,
t1."/BIC/TUCFAMILY" as TUCFAMILY,
t1."/BIC/TUCGLGMNA" as TUCGLGMNA,
t1."/BIC/TUCHAZFLG" as TUCHAZFLG,
t1."/BIC/TUCHORS0" as TUCHORS0_TUCMATERL,
t1."/BIC/TUCHORS1" as TUCHORS1_TUCMATERL,
t1."/BIC/TUCHORS2" as TUCHORS2_TUCMATERL,
t1."/BIC/TUCHORS3" as TUCHORS3_TUCMATERL,
t1."/BIC/TUCHORS4" as TUCHORS4_TUCMATERL,
t1."/BIC/TUCHORS5" as TUCHORS5_TUCMATERL,
t1."/BIC/TUCHORS6" as TUCHORS6_TUCMATERL,
t1."/BIC/TUCHORS7" as TUCHORS7_TUCMATERL,
t1."/BIC/TUCHORS8" as TUCHORS8_TUCMATERL,
t1."/BIC/TUCHORS9" as TUCHORS9_TUCMATERL,
NULL as TUCHORS10,
NULL as TUCHORS11,
NULL as TUCHORS12,
NULL as TUCHORS13,
NULL as TUCHORS14,
NULL as TUCHORS15,
NULL as TUCHORS16,
NULL as TUCHORS17,
NULL as TUCHORS18,
NULL as TUCHORS19,
NULL as TUCHORS20,
NULL as TUCHORS21,
NULL as TUCHORS22,
NULL as TUCHORS23,
NULL as TUCHORS24,
NULL as TUCHORS25,
NULL as TUCHORS26,
NULL as TUCHORS27,
t1."/BIC/TUCINDSER" as TUCINDSER,
t1."/BIC/TUCINT58" as TUCINT58,
t1."/BIC/TUCLDPRLH" as TUCLDPRLH,
t1."/BIC/TUCMAFL" as TUCMAFL,
t1."/BIC/TUCMANDE" as TUCMANDE,
t1."/BIC/TUCMANUMR" as TUCMANUMR,
t1."/BIC/TUCMATLCT" as TUCMATLCT,
t1."/BIC/TUCMATLGP" as TUCMATLGP,
t1."/BIC/TUCMATLTE" as TUCMATLTE,
t1."/BIC/TUCMMATN" as TUCMMATN,
t1."/BIC/TUCMSTAE" as TUCMSTAE,
t1."/BIC/TUCMUPACK" as TUCMUPACK,
t1."/BIC/TUCNSTRSO" as TUCNSTRSO,
t1."/BIC/TUCPROD" as TUCPROD,
t1."/BIC/TUCPRODHR" as TUCPRODHR_TUCMATERL,
t1."/BIC/TUCPRSTM1" as TUCPRSTM1,
t1."/BIC/TUCSIZEDM" as TUCSIZEDM,
t1."/BIC/TUCSLCTM1" as TUCSLCTM1,
t1."/BIC/TUCSLPTM1" as TUCSLPTM1,
t1."/BIC/TUCSUB" as TUCSUB,
t1."/BIC/TUCTSMAT" as TUCTSMAT,
t1."/BIC/TUCVEPAOE" as TUCVEPAOE,
t1."/BIC/TUCVEPARO" as TUCVEPARO,
t1."/BIC/TUCWFAMIL" as TUCWFAMIL,
t1."/BIC/TUCWPROD" as TUCWPROD,
t1."/BIC/TUCZHPPH1" as TUCZHPPH1,
t1."/BIC/TUCZHPPH2" as TUCZHPPH2,
t1."/BIC/TUCZHPPH3" as TUCZHPPH3,
t1."/BIC/TUCZHPPH4" as TUCZHPPH4,

case 
  when t1."/BIC/TUCZZGMNR" = 'SERVICE' then nvl(t3."/BIC/TUCZZLMNR",'SERVICE') 
  else t1."/BIC/TUCZZGMNR" 
end as TUCZZGMNR,

t1."/BIC/TUDCHONN" as TUDCHONN_TUCMATERL,
t1."/BIC/TUDCREATN" as TUDCREATN_TUCMATERL,
t1."/BIC/TUDMSTDEE" as TUDMSTDEE,
t1."/BIC/TUDTANLLH" as TUDTANLLH,
t1."/BIC/TUDTCNTLH" as TUDTCNTLH,
t1."/BIC/TUIOTLH" as TUIOTLH,
t1."/BIC/TUKESTGR" as TUKESTGR,
t1."/BIC/TUKGROSWT" as TUKGROSWT,
t1."/BIC/TUKHEIGHT" as TUKHEIGHT,
t1."/BIC/TUKHORNO" as TUKHORNO_TUCMATERL,
t1."/BIC/TUKHORN1" as TUKHORN1_TUCMATERL,
t1."/BIC/TUKHORN2" as TUKHORN2_TUCMATERL,
t1."/BIC/TUKHORN3" as TUKHORN3_TUCMATERL,
t1."/BIC/TUKHORN4" as TUKHORN4_TUCMATERL,
t1."/BIC/TUKHORN5" as TUKHORN5_TUCMATERL,
t1."/BIC/TUKHORN6" as TUKHORN6_TUCMATERL,
t1."/BIC/TUKHORN7" as TUKHORN7_TUCMATERL,
t1."/BIC/TUKHORN8" as TUKHORN8_TUCMATERL,
t1."/BIC/TUKHORN9" as TUKHORN9_TUCMATERL,
NULL as TUKHORN10,
NULL as TUKHORN11,
NULL as TUKHORN12,
NULL as TUKHORN13,
NULL as TUKHORN14,
NULL as TUKHORN15,
NULL as TUKHORN16,
NULL as TUKHORN17,
NULL as TUKHORN18,
NULL as TUKHORN19,
NULL as TUKHORN20,
NULL as TUKHORN21,
NULL as TUKHORN22,
NULL as TUKHORN23,
NULL as TUKHORN24,
NULL as TUKHORN25,
NULL as TUKHORN26,
NULL as TUKHORN27,
NULL as TUKHORN28,
NULL as TUKHORN29,
t1."/BIC/TUKLENGHT" as TUKLENGHT,
t1."/BIC/TUKNETWET" as TUKNETWET,
t1."/BIC/TUKVOLUME" as TUKVOLUME,
t1."/BIC/TUKWIDTHH" as TUKWIDTHH,
t1."/BIC/TUMOBILH" as TUMOBILH,
t1."/BIC/TUSECURLH" as TUSECURLH,
t1."/BIC/TUTREDULH" as TUTREDULH,
t1."/BIC/TUUBASEUM" as TUUBASEUM_TUCMATERL,
t1."/BIC/TUUCONTUT" as TUUCONTUT,
t1."/BIC/TUUPOUNIT" as TUUPOUNIT,
t1."/BIC/TUUUNITDM" as TUUUNITDM,
t1."/BIC/TUUUNITOT" as TUUUNITOT,
t1."/BIC/TUUVOLUMT" as TUUVOLUMT,
t3."/BIC/TUCAOANR" as TUCAOANR,
t3."/BIC/TUCARCH" as TUCARCH_TUCMATSAS,
t3."/BIC/TUCCKONDM" as TUCCKONDM,
t3."/BIC/TUCDELFLG" as TUCDELFLG_TUCMATSAS,
t3."/BIC/TUCDNDRE" as TUCDNDRE,
t3."/BIC/TUCDWERK" as TUCDWERK,
t3."/BIC/TUCECCGR" as TUCECCGR,
t3."/BIC/TUCFORCAT" as TUCFORCAT,
t3."/BIC/TUCFRTP" as TUCFRTP,
t3."/BIC/TUCH032" as TUCH032,
t3."/BIC/TUCH794" as TUCH794,
t3."/BIC/TUCHCL108" as TUCHCL108,
t3."/BIC/TUCHCL62F" as TUCHCL62F,
t3."/BIC/TUCHCOSET" as TUCHCOSET,
t3."/BIC/TUCHM1447" as TUCHM1447,
t3."/BIC/TUCHORS0" as TUCHORS0_TUCMATSAS,
t3."/BIC/TUCHORS1" as TUCHORS1_TUCMATSAS,
t3."/BIC/TUCHORS2" as TUCHORS2_TUCMATSAS,
t3."/BIC/TUCHORS3" as TUCHORS3_TUCMATSAS,
t3."/BIC/TUCHORS4" as TUCHORS4_TUCMATSAS,
t3."/BIC/TUCHORS5" as TUCHORS5_TUCMATSAS,
t3."/BIC/TUCHORS6" as TUCHORS6_TUCMATSAS,
t3."/BIC/TUCHORS7" as TUCHORS7_TUCMATSAS,
t3."/BIC/TUCHORS8" as TUCHORS8_TUCMATSAS,
t3."/BIC/TUCHORS9" as TUCHORS9_TUCMATSAS,
t3."/BIC/TUCIAUTRE" as TUCIAUTRE,
t3."/BIC/TUCINT01" as TUCINT01,
t3."/BIC/TUCINT031" as TUCINT031,
NULL as TUCINT10,
NULL as TUCINT104,
NULL as TUCINT11,
NULL as TUCINT12,
t3."/BIC/TUCINT123" as TUCINT123,
t3."/BIC/TUCINT13" as TUCINT13,
NULL as TUCINT14,
t3."/BIC/TUCINT37" as TUCINT37,
t3."/BIC/TUCINT401" as TUCINT401,
t3."/BIC/TUCINT403" as TUCINT403,
t3."/BIC/TUCINT47" as TUCINT47,
t3."/BIC/TUCINT50" as TUCINT50,
t3."/BIC/TUCINT55" as TUCINT55,
t3."/BIC/TUCINT56" as TUCINT56,
t3."/BIC/TUCINT57" as TUCINT57,
t3."/BIC/TUCINT61" as TUCINT61,
t3."/BIC/TUCINT63" as TUCINT63,
t3."/BIC/TUCINT65" as TUCINT65,
NULL as TUCINT70,
t3."/BIC/TUCINT73" as TUCINT73,
t3."/BIC/TUCINT81" as TUCINT81,
t3."/BIC/TUCINT96" as TUCINT96,
t3."/BIC/TUCINT98" as TUCINT98,
t3."/BIC/TUCINTANL" as TUCINTANL,
t3."/BIC/TUCINTCTR" as TUCINTCTR,
t3."/BIC/TUCINTEDU" as TUCINTEDU,
t3."/BIC/TUCINTIOT" as TUCINTIOT,
t3."/BIC/TUCINTMOB" as TUCINTMOB,
t3."/BIC/TUCINTNON" as TUCINTNON,
t3."/BIC/TUCINTSEC" as TUCINTSEC,
t3."/BIC/TUCKTGRM" as TUCKTGRM,
t3."/BIC/TUCMATLG1" as TUCMATLG1,
t3."/BIC/TUCMATLG2" as TUCMATLG2,
t3."/BIC/TUCMATLG3" as TUCMATLG3,
t3."/BIC/TUCMATLG4" as TUCMATLG4,
t3."/BIC/TUCMATLG5" as TUCMATLG5,
t3."/BIC/TUCMTPOS" as TUCMTPOS,
t3."/BIC/TUCOANR" as TUCOANR,
t3."/BIC/TUCPABC" as TUCPABC,
t3."/BIC/TUCPFLAG" as TUCPFLAG,
t3."/BIC/TUCPRAT1" as TUCPRAT1,
t3."/BIC/TUCPRAT2M" as TUCPRAT2M,
t3."/BIC/TUCPRAT3M" as TUCPRAT3M,
NULL as TUCPRAT4,
t3."/BIC/TUCPRAT4M" as TUCPRAT4M,
t3."/BIC/TUCPRAT5M" as TUCPRAT5M,
t3."/BIC/TUCPRAT7M" as TUCPRAT7M,
t3."/BIC/TUCPRAT8M" as TUCPRAT8M,
t3."/BIC/TUCPRATA" as TUCPRATA,
t3."/BIC/TUCPRDHI1" as TUCPRDHI1,
t3."/BIC/TUCPRDHI2" as TUCPRDHI2,
t3."/BIC/TUCPRDHI3" as TUCPRDHI3,
t3."/BIC/TUCPRODHR" as TUCPRODHR_TUCMATSAS,
t3."/BIC/TUCRATE" as TUCRATE,
t3."/BIC/TUCREBATP" as TUCREBATP,
t3."/BIC/TUCSALNOT" as TUCSALNOT,
t3."/BIC/TUCSAOABC" as TUCAOABC,
t3."/BIC/TUCSPHAI" as TUCSPHAI,
t3."/BIC/TUCTDFPOE" as TUCTDFPOE,
t3."/BIC/TUCTFORCA" as TUCTFORCA,
t3."/BIC/TUCVALP" as TUCVALP,
t3."/BIC/TUCVMSTA" as TUCVMSTA,
t3."/BIC/TUCWRRNT" as TUCWRRNT,
t3."/BIC/TUCYVENPL" as TUCYVENPL,
t3."/BIC/TUCZZLMNR" as TUCZZLMNR,
t3."/BIC/TUDCHONN" as TUDCHONN_TUCMATSAS,
t3."/BIC/TUDCONVFF" as TUDCONVFF,
t3."/BIC/TUDCREATN" as TUDCREATN_TUCMATSAS,
t3."/BIC/TUDDNDEXP" as TUDDNDEXP,
t3."/BIC/TUDLSODAT" as TUDLSODAT,
NULL as TUDPLAVFF,
t3."/BIC/TUDVMSTDD" as TUDVMSTDD,
t3."/BIC/TUKAAGE" as TUKAAGE,
t3."/BIC/TUKHORN1" as TUKHORN1_TUCMATSAS,
t3."/BIC/TUKHORN2" as TUKHORN2_TUCMATSAS,
t3."/BIC/TUKHORN3" as TUKHORN3_TUCMATSAS,
t3."/BIC/TUKHORN4" as TUKHORN4_TUCMATSAS,
t3."/BIC/TUKHORN5" as TUKHORN5_TUCMATSAS,
t3."/BIC/TUKHORN6" as TUKHORN6_TUCMATSAS,
t3."/BIC/TUKHORN7" as TUKHORN7_TUCMATSAS,
t3."/BIC/TUKHORN8" as TUKHORN8_TUCMATSAS,
t3."/BIC/TUKHORN9" as TUKHORN9_TUCMATSAS,
t3."/BIC/TUKHORNO" as TUKHORNO_TUCMATSAS,
t3."/BIC/TUKPRMAC" as TUKPRMAC,
t3."/BIC/TUKPRMDP" as TUKPRMDP,
t3."/BIC/TUKPRMLP" as TUKPRMLP,
t3."/BIC/TUKPRMPC" as TUKPRMPC,
t3."/BIC/TUUBASEUM" as TUUBASEUM_TUCMATSAS,
t3."/BIC/TUYKONACC" as TUYKONACC,
t3."/BIC/TUYKONDPP" as TUYKONDPP,
t3."/BIC/TUYKONLPP" as TUYKONLPP,
t3."/BIC/TUYKONPCC" as TUYKONPCC,
NULL as GM_MANPRODNR,
NULL as GM_MANUF_NAME,
NULL as GM_PRODUCT_DESC,
NULL as GM_PRODTEXT_SAP,
NULL as GM_SHORT_DESC,
NULL as GM_TRADEPRICE,
NULL as GM_ITEM_CAT_GRP,
NULL as GM_RRP,
NULL as GM_STOCK,
NULL as GM_STOCK_DELIVERY_DATE,
NULL as GM_WEIGHT,
NULL as GM_PICTURE_URL,
NULL as GM_F32,

--t5.MANPRODNR as GM_MANPRODNR,
--t5.MANUF_NAME as GM_MANUF_NAME,
--t5.PRODUCT_DESC as GM_PRODUCT_DESC,
--t5.PRODTEXT_SAP as GM_PRODTEXT_SAP,
--t5.SHORT_DESC as GM_SHORT_DESC,
--t5.TRADEPRICE as GM_TRADEPRICE,
--t5.ITEM_CAT_GRP as GM_ITEM_CAT_GRP,
--t5.RRP as GM_RRP,
--t5.STOCK as GM_STOCK,
--t5.STOCK_DELIVERY_DATE as GM_STOCK_DELIVERY_DATE,
--t5.WEIGHT as GM_WEIGHT,
--t5.PICTURE_URL as GM_PICTURE_URL,
--t5.F32 as GM_F32,

case 
  when (t3."/BIC/TUCVMSTA" = '' 
     or t3."/BIC/TUCVMSTA" is null 
	 or t3."/BIC/TUCVMSTA" < 70) 
	 and t3."/BIC/TUCINT65" = '' 
	 and t3."/BIC/TUCINT01" = '' 
    then true 
  else false 
end as activity_flag_country,

case 
  when t6."/BIC/TUCMATERL" is not null then true 
  else false
end as activity_flag
,SYSDATE() as UPDATE_DATE_UTC
,NULL as TNSALEORG
from {{ source('us_cdp_bw_46','TUCMATERL') }}  as t1 
join {{ source('us_cdp_bw_46','TUCMATSAS') }}  as t3 
  on t1."/BIC/TUCMATERL" = t3."/BIC/TUCMATSAS"
  and t1.SOURSYSTEM = t3.SOURSYSTEM
  and  t3."/BIC/TUCDISTRN" = '00'    
    
left join t6
  on t1."/BIC/TUCMATERL" = t6."/BIC/TUCMATERL"

-- fixed intouch product hierarchy  *****jdb - switched to using t1 values from TUCMATERL
--left join EU_DATAPRACTICE.EU_ANALYTICS_PROD_VIEWS.TECINPRODHIERARCHY t2 
--  on t1."/BIC/TECSUB" = t2.TECSUBFIXED
  
-- local manufacturer to global manufacturer mapping  *****JDB - No mapping available yet
--left join eu_analytics_prod_views.teczzlmnr_teczzgmnr_mapping as t4 
--  on t3."/BIC/TUCZZLMNR" = t4."/BIC/TUCzzlmnr

-- selected goldmine data  *****JDB Commented out as not sure where to pull Goldmine data from*****
-- left join goldmine.gm_datapack as t5 
--  on t3."/BIC/TUCSALESG" = t5.COUNTRY_CODE 
--  and t1."/BIC/TUCMATERL" = t5.prodnr
  
-- active_products (when there is no sales block & product is displayed in intouch & product is not banned from displaying)



union all

(select 
md5(concat(t1.SOURSYSTEM,t1."/BIC/TNMATERIL", t4."/BIC/TNSALEORG" ,nvl(t4."/BIC/TNDISTNCH",''))) as pkey_material,
t1.SOURSYSTEM as SOURSYSTEM,
t1."/BIC/TNMATERIL" as TUCMATERL,
t1.objvers as OBJVERS,
t4."/BIC/TNSALEORG" as TUCSALESG, 
nvl(t4."/BIC/TNDISTNCH",'') as TUCDISTRN,
t4."/BIC/TNMATSLS" as TUCMATSAS,
NULL as LOGSYS,
t1."/BIC/TNMATACFL" as TUCACTC,
NULL as TUCAESZNN,
NULL as TUCARCH_TUCMATERL,
NULL as TUCBUNDFL,
NULL as TUCCNETL1,
NULL as TUCCNETL2,
NULL as TUCCNETL3,
NULL as TUCCNETL4,
NULL as TUCCNETL5,
NULL as TUCCNETL6,
NULL as TUCCNETL7,
NULL as TUCCNETL8,
NULL as TUCCOMCHA,
NULL as TUCCOMPER,
NULL as TUCDELFLG_TUCMATERL,
NULL as TUCDIVISN,
NULL as TUCEANUPC,
NULL as TUCEKWSL,
NULL as TUCEXTMAP,
NULL as TUCFAMILY,
NULL as TUCGLGMNA,
NULL as TUCHAZFLG,
NULL as TUCHORS0_TUCMATERL,
NULL as TUCHORS1_TUCMATERL,
NULL as TUCHORS10,
NULL as TUCHORS11,
NULL as TUCHORS12,
NULL as TUCHORS13,
NULL as TUCHORS14,
NULL as TUCHORS15,
NULL as TUCHORS16,
NULL as TUCHORS17,
NULL as TUCHORS18,
NULL as TUCHORS19,
NULL as TUCHORS2_TUCMATERL,
NULL as TUCHORS20,
NULL as TUCHORS21,
NULL as TUCHORS22,
NULL as TUCHORS23,
NULL as TUCHORS24,
NULL as TUCHORS25,
NULL as TUCHORS26,
NULL as TUCHORS27,
NULL as TUCHORS3_TUCMATERL,
NULL as TUCHORS4_TUCMATERL,
NULL as TUCHORS5_TUCMATERL,
NULL as TUCHORS6_TUCMATERL,
NULL as TUCHORS7_TUCMATERL,
NULL as TUCHORS8_TUCMATERL,
NULL as TUCHORS9_TUCMATERL,
NULL as TUCINDSER,
NULL as TUCINT58,
NULL as TUCLDPRLH,
NULL as TUCMAFL,
NULL as TUCMANDE,
t1."/BIC/TNMFR_MAT" as TUCMANUMR,
NULL as TUCMATLCT,
NULL as TUCMATLGP,
t1."/BIC/TNMATLTYP" as TUCMATLTE,
NULL as TUCMMATN,
NULL as TUCMSTAE,
NULL as TUCMUPACK,
NULL as TUCNSTRSO,
NULL as TUCPROD,
NULL as TUCPRODHR_TUCMATERL,
NULL as TUCPRSTM1,
NULL as TUCSIZEDM,
NULL as TUCSLCTM1,
NULL as TUCSLPTM1,
NULL as TUCSUB,
NULL as TUCTSMAT,
NULL as TUCVEPAOE,
NULL as TUCVEPARO,
NULL as TUCWFAMIL,
NULL as TUCWPROD,
t1."/BIC/TNPRODH1" as TUCZHPPH1,
NULL as TUCZHPPH2,
NULL as TUCZHPPH3,
NULL as TUCZHPPH4,

-- if 4.6 representation of GM is missing use 6.8 GM -> if this is in list ('OTHER','HP AUCTION','SERVICE','TRAINING','','TECH DATA') then rather use 4.6 representation of field manufacturer, otherwise use 4.6 representation of global manufacturer
-- case 
-- 	when t1.soursystem = 'A2' 
-- 	  and  coalesce(t2.tuczzgmnr_46, t1.zgmanfact) in ('OTHER','HP AUCTION','SERVICE','TRAINING','','TUCH DATA') 
-- 	  then coalesce(t3.tuczzgmnr_46, t1.tnmanufac)
-- 	when t1.soursystem = 'A2' 
-- 	  and  coalesce(t2.tuczzgmnr_46, t1.zgmanfact) not in ('OTHER','HP AUCTION','SERVICE','TRAINING','', 'TUCH DATA') 
-- 	  then coalesce(t2.tuczzgmnr_46, t1.zgmanfact)
-- 	else t1.zgmanfact 
-- end as TUCZZGMNR,
-- t1."/BIC/ZGMANFACT" as TUCZZGMNR,
t1."/BIC/TNMANUFAC" as TUCZZGMNR,

NULL as TUDCHONN_TUCMATERL,
t1.createdon as TUDCREATN_TUCMATERL,
NULL as TUDMSTDEE,
NULL as TUDTANLLH,
NULL as TUDTCNTLH,
NULL as TUIOTLH,
NULL as TUKESTGR,
NULL as TUKGROSWT,
NULL as TUKHEIGHT,
NULL as TUKHORN1_TUCMATERL,
NULL as TUKHORN10,
NULL as TUKHORN11,
NULL as TUKHORN12,
NULL as TUKHORN13,
NULL as TUKHORN14,
NULL as TUKHORN15,
NULL as TUKHORN16,
NULL as TUKHORN17,
NULL as TUKHORN18,
NULL as TUKHORN19,
NULL as TUKHORN2_TUCMATERL,
NULL as TUKHORN20,
NULL as TUKHORN21,
NULL as TUKHORN22,
NULL as TUKHORN23,
NULL as TUKHORN24,
NULL as TUKHORN25,
NULL as TUKHORN26,
NULL as TUKHORN27,
NULL as TUKHORN28,
NULL as TUKHORN29,
NULL as TUKHORN3_TUCMATERL,
NULL as TUKHORN4_TUCMATERL,
NULL as TUKHORN5_TUCMATERL,
NULL as TUKHORN6_TUCMATERL,
NULL as TUKHORN7_TUCMATERL,
NULL as TUKHORN8_TUCMATERL,
NULL as TUKHORN9_TUCMATERL,
NULL as TUKHORNO_TUCMATERL,
NULL as TUKLENGHT,
NULL as TUKNETWET,
NULL as TUKVOLUME,
NULL as TUKWIDTHH,
NULL as TUMOBILH,
NULL as TUSECURLH,
NULL as TUTREDULH,
NULL as TUUBASEUM_TUCMATERL,
NULL as TUUCONTUT,
NULL as TUUPOUNIT,
NULL as TUUUNITDM,
NULL as TUUUNITOT,
NULL as TUUVOLUMT,
NULL as TUCAOANR,
NULL as TUCARCH_TUCMATSAS,
NULL as TUCCKONDM,
NULL as TUCDELFLG_TUCMATSAS,
NULL as TUCDNDRE,
NULL as TUCDWERK,
NULL as TUCECCGR,
NULL as TUCFORCAT,
NULL as TUCFRTP,
NULL as TUCH032,
NULL as TUCH794,
NULL as TUCHCL108,
NULL as TUCHCL62F,
NULL as TUCHCOSET,
NULL as TUCHM1447,
NULL as TUCHORS0_TUCMATSAS,
NULL as TUCHORS1_TUCMATSAS,
NULL as TUCHORS2_TUCMATSAS,
NULL as TUCHORS3_TUCMATSAS,
NULL as TUCHORS4_TUCMATSAS,
NULL as TUCHORS5_TUCMATSAS,
NULL as TUCHORS6_TUCMATSAS,
NULL as TUCHORS7_TUCMATSAS,
NULL as TUCHORS8_TUCMATSAS,
NULL as TUCHORS9_TUCMATSAS,
NULL as TUCIAUTRE,
NULL as TUCINT01,
NULL as TUCINT031,
NULL as TUCINT10,
NULL as TUCINT104,
NULL as TUCINT11,
NULL as TUCINT12,
NULL as TUCINT123,
NULL as TUCINT13,
NULL as TUCINT14,
NULL as TUCINT37,
NULL as TUCINT401,
NULL as TUCINT403,
NULL as TUCINT47,
NULL as TUCINT50,
NULL as TUCINT55,
NULL as TUCINT56,
NULL as TUCINT57,
NULL as TUCINT61,
NULL as TUCINT63,
NULL as TUCINT65,
NULL as TUCINT70,
NULL as TUCINT73,
NULL as TUCINT81,
NULL as TUCINT96,
NULL as TUCINT98,
NULL as TUCINTANL,
NULL as TUCINTCTR,
NULL as TUCINTUDU,
NULL as TUCINTIOT,
NULL as TUCINTMOB,
NULL as TUCINTNON,
NULL as TUCINTSEC,
t4."/BIC/TNMTKTGRM" as TUCKTGRM,
NULL as TUCMATLG1,
NULL as TUCMATLG2,
NULL as TUCMATLG3,
NULL as TUCMATLG4,
NULL as TUCMATLG5,
NULL as TUCMTPOS,
NULL as TUCOANR,
NULL as TUCPABC,
NULL as TUCPFLAG,
NULL as TUCPRAT1,
NULL as TUCPRAT2M,
NULL as TUCPRAT3M,
NULL as TUCPRAT4,
NULL as TUCPRAT4M,
NULL as TUCPRAT5M,
NULL as TUCPRAT7M,
NULL as TUCPRAT8M,
NULL as TUCPRATA,
NULL as TUCPRDHI1,
NULL as TUCPRDHI2,
NULL as TUCPRDHI3,
t4."/BIC/TNPRODHIE" as TUCPRODHR_TUCMATSAS,
NULL as TUCRATE,
NULL as TUCREBATP,
NULL as TUCSALNOT,
NULL as TUCSAOABC,
NULL as TUCSPHAI,
NULL as TUCTDFPOE,
NULL as TUCTFORCA,
NULL as TUCVALP,
NULL as TUCVMSTA,
NULL as TUCWRRNT,
NULL as TUCYVENPL,
NULL as TUCZZLMNR,
NULL as TUDCHONN_TUCMATSAS,
NULL as TUDCONVFF,
NULL as TUDCREATN_TUCMATSAS,
NULL as TUDDNDEXP,
NULL as TUDLSODAT,
NULL as TUDPLAVFF,
NULL as TUDVMSTDD,
NULL as TUKAAGE,
NULL as TUKHORN1_TUCMATSAS,
NULL as TUKHORN2_TUCMATSAS,
NULL as TUKHORN3_TUCMATSAS,
NULL as TUKHORN4_TUCMATSAS,
NULL as TUKHORN5_TUCMATSAS,
NULL as TUKHORN6_TUCMATSAS,
NULL as TUKHORN7_TUCMATSAS,
NULL as TUKHORN8_TUCMATSAS,
NULL as TUKHORN9_TUCMATSAS,
NULL as TUKHORNO_TUCMATSAS,
NULL as TUKPRMAC,
NULL as TUKPRMDP,
NULL as TUKPRMLP,
NULL as TUKPRMPC,
NULL as TUUBASEUM_TUCMATSAS,
NULL as TUYKONACC,
NULL as TUYKONDPP,
NULL as TUYKONLPP,
NULL as TUYKONPCC,
NULL as GM_MANPRODNR,
NULL as GM_MANUF_NAME,
NULL as GM_PRODUCT_DESC,
NULL as GM_PRODTEXT_SAP,
NULL as GM_SHORT_DESC,
NULL as GM_TRADEPRICE,
NULL as GM_ITUM_CAT_GRP,
NULL as GM_RRP,
NULL as GM_STOCK,
NULL as GM_STOCK_DELIVERY_DATE,
NULL as GM_WEIGHT,
NULL as GM_PICTURE_URL,
NULL as GM_F32,

case 
	when t1."/BIC/TNMATACFL" = 'X' then true 
	else false 
    end as activity_flag_country,

case 
	when t1."/BIC/TNMATACFL" = 'X' then true 
	else false 
	end as activity_flag
    
,SYSDATE() as UPDATE_DATE_UTC
,t4."/BIC/TNSALEORG" as TNSALEORG
from {{ source('us_cdp_bw_68','TNMATERIL') }}  as t1
join {{ source('us_cdp_bw_68','TNMATSLS') }} as  t4
  on t1."/BIC/TNMATERIL" = t4."/BIC/TNMATSLS" 		
  and t1.soursystem = t4.soursystem 
  and t1.objvers = t4.objvers
  and "/BIC/TNDISTNCH" = '01'
  and t4."/BIC/TNSALEORG" in('1001', 'US33', 'A001')
  where t1.soursystem = 'A2' )